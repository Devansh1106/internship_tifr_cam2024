\section{Finite Volume Methods}
\subsection{Motivation for Finite Volume Method}
In finite difference methods, the derivatives are approximated by finite differences -- esssentially using Taylor expansion. A large discussion on finite difference  methods shows that they need the solution to be smooth and equation to be satisfied point-wise. However, the solutions to the scalar conservation law (\ref{1}) are not necessarily smooth, so the Taylor expansion -- replacing derivatives using finite differences -- is no longer valid. Hence, we need a new framework for designing numerical methods for scalar conservation laws.

 This chapter introduces the finite volume method for the numerical solution of hyperbolic PDE and system of hyperbolic PDEs. We will talk about fundamental concept of this method and also discuss a type of numerical flux. 

\subsection{Formulation for conservation laws}
The basic difference between finite difference methods and finite volume methods is that finite volume methods are derived on the basis of integral form of the conservation laws, instead of the differential form as in finite differences.

For the case of one spatial dimension:
\begin{equation} \label{1}
u_t + f(u)_x = 0
\end{equation}
the domain is divided into finite volumes (or \textit{grid cells/intervals}) and we need to monitor the approximation to the integral of $u$ over each of these volumes. For each time step, we need to update $u$ using the approximation to the flux $f(u)$ that comes in and goes out from the boundary of these volumes.

If we denote $i$ th volume by:
\begin{equation}
C_i = (x_{i-1/2},x_{i+1/2})
\end{equation}
The value $U^n_i$ will approximate the average value of $u$ over the $i$th interval at time $t^n$
\begin{equation}
U_i^n \approx \frac{1}{\Delta x}\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t_n) dx
\end{equation}
where $\Delta x=x_(i+1/2)-x_(i-1/2 )$ is the length of the cell. Here we are assuming a uniform grid for easeness of explanantion.\\
$\sum_{i=1}^N U_i^n \Delta x$ approximates the integral of $u$ over the entire $1D$ domain and if we use the method that is in conservative form, the value of $\sum_{i=1}^N U^n_i \Delta x$ will only change due to the fluxes at the boundary of the domain.\\
Now, we will see how can we develop an explicit time-marching algorithm using integral form of the conservation law. We can get integral form by integrating (\ref{1}) on interval $C_i$. Steps have been shown below:
\begin{gather*}
\int_{C_i}\frac{d}{dt} u(x,t_n) dx +\int_{C_i} \frac{d}{dx} f(u(x,t_n)) = 0 \\
\frac{d}{dt}\int_{C_i}u(x, t_n)dx =  f(u(x_{i-1/2}, t_n)) - f(u(x_{i+1/2},t_n))
\end{gather*}
For given $U_i^n$, the cell averages at time $t_n$, we can approximate the cell averages at time $t_{n+1}$, $U_i^{n+1}$, after a time step of length $\Delta t = t_{n+1} - t_n$. \\
Integrating the above equation in time from $t_n$ to $t_{n+1}$:
\begin{align*}
\int_{t_n}^{t_{n+1}} \frac{d}{dt} \int_{C_i} u(x, t_n) dx &= \int_{t_n}^{t_{n+1}} f(u(x_{i-1/2}, t_n)) - f(u(x_{i+1/2}, t_n)) \\
\int_{C_i} u(x, t_{n+1})dx - \int_{C_i} u(x, t_n)dx &=  \int_{t_n}^{t_{n+1}} f(u(x_{i-1/2}, t_n)) dt - \int_{t_n}^{t_{n+1}} f(u(x_{i+1/2}, t_n)) dt
\end{align*}
Rearranging this equation and dividing both sides by $\Delta x$ yields:
\begin{align} \label{4}
\begin{split}
\frac{1}{\Delta x} \int_{C_i} u(x, t_{n+1}) dx &= \frac{1}{\Delta x} \int_{C_i} u(x, t_n) dx \\ &- \frac{1}{\Delta x} \left[ \int_{t_n}^{t_{n+1}} f(u(x_{i-1/2}, t_n)) dt -  \int_{t_n}^{t_{n+1}} f(u(x_{i+1/2}, t_n)) dt \right]
\end{split}
\end{align}

In (\ref{4}), we can not evaluate the time integrals on the right hand side exactly, as $u(x_{i\pm1/2})$ varies with time along each edge of the cell. We can rewrite eq (\ref{4}) as:
\begin{equation}
U_i^{n+1} = U_i^n - \frac{\Delta t}{\Delta x} \left(F_{i+1/2}^n - F_{i-1/2}^n \right)
\end{equation}
where $F_{i-1/2}^n $ is the \textit{average} flux along $ x = x_{i-1/2}$:
\begin{equation*}
F_{i-1/2}^n  =  \frac{1}{\Delta t} \int_{t_n}^{t_{n+1}} f(u(x_{i-1/2},t_n)) dt
\end{equation*}
If we can approximate this \textit{average flux} function based on the values of $U^n$, then we will have a discrete method. And that approximation to \textit{average flux}  function is called \textit{numerical flux function}.

\subsection{The CFL Condition}
The \textit{numerical flux} function as the approximation of \textit{average flux} is the main ingredient in a finite volume scheme. We need a approximation to:
\begin{equation}
\bar{F}^n_{j+1/2} \approx F^n_{i-1/2} =  \frac{1}{\Delta t}\int_{t_n}^{t^{n+1}} f(u(x_{i-1/2}, t_n)) dt
\end{equation}
at each interface $x_{i-1/2}$. As the cell averages $U^n_j$ are constant in each cell $C_j$, at each time level, we can define at each cell interface $x_{i-1/2}$ a, \textit{Riemann problem}:
\begin{equation} \label{7}
\begin{cases}
u_t + f(u)_x = 0 \\
u(x, t_n) = & \hspace{-28pt}
\begin{cases}
u^n_j  &  \text{if} \hspace{4pt} x < x_{j-1/2} \\
u^n_{j+1} & \text{if} \hspace{4pt} x > x_{j-1/2}
\end{cases}
\end{cases}
\end{equation}
At every time level, the cell averages define a superposition of $Riemann$ problems of the form (\ref{7}), at each interface. The solution to the $Riemann$ problem consists of shock waves, rarefraction and compound waves. Moreover, waves from neighboring \textit{Riemann} problems can intersect after some time hence imposing the CFL condition is a requirement. We define \textit{Courant number} as:
\begin{equation} \label{8}
v = \frac{\Delta t}{\Delta x} \max_p\mid\lambda^p\mid
\end{equation}
where $\lambda$'s are the $eigenvalues$ of a matrix $A$, in the case of system of linear hyperbolic equations and $\lambda$ can be the wave propogation speed in the case of a single hyperbolic PDE.

For a three point stencil the CFL condition leads to $v \leq 1$. It can be noted that for a wider stencils, the CFL condition can give $v \leq 2$. The CFL condition is a $necessary$ but not a sufficient condition for stability of the solution.
\subsection{Rusanov's flux: A stable numerical flux}

\subsection{Lax-Wendroff method}
Lax-wendroff method is a numerical method for solving system of hyperbolic conservation laws. It is a second order accurate method in both space and time. This method can be derived using
$Taylor's~expansion.$ We will demonstrate the derivation of this method for $linear~advection~equation$ in $1$D:
\begin{equation} \label{9}
    u_t + au_x = 0
\end{equation}
The $Taylor's~expansion$ in $1$D looks like:
\begin{equation}
    u_j^{n+1} = u_j^n + \Delta t \frac{\partial u}{\partial t}\bigg\vert_j^n + \frac{(\Delta t)^2}{2}\frac{\partial^2 u}{\partial t^2}\bigg\vert_j^n + \dots
\end{equation}
From eq (\ref{9}), we can write $ u_t = -au_x$ and for $u_{tt}$ we can differentiate eq (\ref{9}):
\begin{equation}
    u_{tt} = 
\end{equation}